<!DOCTYPE html>
<html lang="zh-cn">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="ä½¿ç”¨æ‡’åŠ è½½å’ŒSuspenseæé«˜Reactæ€§èƒ½"/><meta name="keywords" content="é™ˆé‘«è°±,xinpu,æ˜•æµ¦,xinpuchen,å‰ç«¯,frontend-notes,awesome-coding" /><link rel="alternate" href="/atom.xml" title="Xinpu's Blog"><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=2.11.0" />
<link rel="canonical" href="https://xinpuchen.github.io/improve-react-performance-using-lazy-loading-and-suspense/"/>

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" /><script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0" />

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":true};
</script>

    <title>ä½¿ç”¨æ‡’åŠ è½½å’ŒSuspenseæé«˜Reactæ€§èƒ½ - Xinpu's Blog</title>
  <meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Xinpu's Blog" type="application/atom+xml">
</head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Xinpu's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">é¦–é¡µ
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">å½’æ¡£
          </li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">åˆ†ç±»
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">æ ‡ç­¾
          </li>
      </a><a href="https://xinpuchen.top/frontend-notes/" target="_blank" rel="noopener">
        <li class="mobile-menu-item">å‰ç«¯ç¬”è®°
          </li>
      </a><a href="https://xinpuchen.top/awesome-coding/" target="_blank" rel="noopener">
        <li class="mobile-menu-item">ç®—æ³•ç»ƒä¹ 
          </li>
      </a><a href="/about/">
        <li class="mobile-menu-item">å…³äº
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Xinpu's Blog</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            é¦–é¡µ
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            å½’æ¡£
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/categories/">
            åˆ†ç±»
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            æ ‡ç­¾
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="https://xinpuchen.top/frontend-notes/" target="_blank" rel="noopener">
            å‰ç«¯ç¬”è®°
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="https://xinpuchen.top/awesome-coding/" target="_blank" rel="noopener">
            ç®—æ³•ç»ƒä¹ 
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about/">
            å…³äº
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">ä½¿ç”¨æ‡’åŠ è½½å’ŒSuspenseæé«˜Reactæ€§èƒ½
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-01-25
        </span><span class="post-category">
            <a href="/categories/React/">React</a>
            </span>
        </div>
    </header>

    <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ä»€ä¹ˆæ˜¯-Lazy-LoadingğŸ’¤ï¼Ÿ"><span class="toc-text">ä»€ä¹ˆæ˜¯ Lazy LoadingğŸ’¤ï¼Ÿ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SSR-CSR-å’Œ-React"><span class="toc-text">SSR, CSR å’Œ React</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#â¬Dynamic-Import"><span class="toc-text">â¬Dynamic Import</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ğŸ’¤React-lazy"><span class="toc-text">ğŸ’¤React.lazy()</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ğŸš¦React-Suspense"><span class="toc-text">ğŸš¦React Suspense</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ğŸ‘®-æ•è·åŠ è½½é”™è¯¯"><span class="toc-text">ğŸ‘® æ•è·åŠ è½½é”™è¯¯</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#âœ‚-åŸºäºè·¯ç”±ï¼ˆroute-basedï¼‰çš„ä»£ç æ‹†åˆ†"><span class="toc-text">âœ‚ åŸºäºè·¯ç”±ï¼ˆroute-basedï¼‰çš„ä»£ç æ‹†åˆ†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ğŸ”ª-åŸºäºç»„ä»¶ï¼ˆComponent-basedï¼‰çš„ä»£ç æ‹†åˆ†"><span class="toc-text">ğŸ”ª åŸºäºç»„ä»¶ï¼ˆComponent-basedï¼‰çš„ä»£ç æ‹†åˆ†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ğŸ”š-ç»“è®º"><span class="toc-text">ğŸ”š ç»“è®º</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ğŸ’Credits"><span class="toc-text">ğŸ’Credits</span></a></li></ol>
    </div>
  </div><div class="post-content"><p>Lazy loadingğŸ’¤ å·²ç»æˆä¸ºè¢«å¹¿æ³›åº”ç”¨äºåŠ è½½æé€Ÿçš„ä¼˜åŒ–æŠ€æœ¯ä¹‹ä¸€ã€‚å»¶è¿ŸåŠ è½½çš„å‰æ™¯æœ‰åŠ©äºå°†æŸäº› web app å‡ºç°ç¨‹åºæ€§èƒ½é—®é¢˜çš„é£é™©é™è‡³æœ€ä½ã€½ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶å¦‚ä½•ä½¿ç”¨ Lazy loadingğŸ’¤ æ¥ä¼˜åŒ– React åº”ç”¨ç¨‹åºä¸­çš„åŠ è½½æ—¶é—´ã€‚</p>
<a id="more"></a>

<h1 id="ä»€ä¹ˆæ˜¯-Lazy-LoadingğŸ’¤ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-Lazy-LoadingğŸ’¤ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ Lazy LoadingğŸ’¤ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ Lazy LoadingğŸ’¤ï¼Ÿ</h1><p>æ‡’åŠ è½½æ˜¯ä¸€ç§ä¼˜åŒ–æŠ€å·§ ğŸ’« æˆ‘ä»¬é€šè¿‡å»¶è¿Ÿå¯¹è±¡(å›¾ç‰‡ ğŸ¦, è§†é¢‘ ğŸ¬, ç½‘é¡µ ğŸŒ, éŸ³ä¹ ğŸ¶, æ–‡æ¡£ ğŸ“‹) åŠ è½½ç›´åˆ°ä»–ä»¬è¢«ä½¿ç”¨ã€‚</p>
<p>å½“ç”¨æˆ·æ‰“å¼€ä¸€ä¸ªé¡µé¢ï¼Œæ‰€æœ‰çš„å†…å®¹å°†ä¸€æ¬¡æ€§ä¸‹è½½ä¸‹æ¥ã€‚å¤§å¤šæ•°å†…å®¹å¯èƒ½æ°¸è¿œä¹Ÿä¸ä¼šå‘ç”Ÿä½œç”¨æˆ–è€…è¢«ç”¨æˆ·çœ‹è§ã€‚æ‰€ä»¥ä¸ºä»€ä¹ˆè¦æµªè´¹å®è´µçš„èµ„æºå’Œå¸¦å®½å‘¢ï¼Ÿ</p>
<p>ä¸ºäº†æé«˜æˆ‘ä»¬ç½‘ç«™çš„å“åº”æ—¶é—´ï¼Œæˆ‘ä»¬é€‰æ‹©å»¶è¿ŸåŠ è½½ä¸€äº›åº”ç”¨ç¨‹åºä¸­çš„éå…³é”®éƒ¨åˆ†ã€‚å½“ç”¨æˆ·éœ€è¦è®¿é—®è¿™äº›éƒ¨åˆ†çš„æ—¶å€™ï¼Œå†åŠ è½½è¿™äº›èµ„æºã€‚</p>
<h1 id="SSR-CSR-å’Œ-React"><a href="#SSR-CSR-å’Œ-React" class="headerlink" title="SSR, CSR å’Œ React"></a>SSR, CSR å’Œ React</h1><p>æˆ‘ä»¬æœ‰ SSR(server-side rendered / æœåŠ¡ç«¯å‘ˆç°)åº”ç”¨ç¨‹åºå’Œ CSR(Client side rendered / å®¢æˆ·ç«¯å‘ˆç°)åº”ç”¨ç¨‹åºã€‚</p>
<p>SSR æ˜¯ä½¿ç”¨.HTML æ„å»ºçš„ä¼˜ç§€ä¼ ç»Ÿé¡µé¢ï¼Œå¯ä»¥é€‰æ‹©é…åˆ ASP.NEt æˆ–æ˜¯ PHP ç­‰æ¥ä½¿ç”¨ã€‚æ¯ä¸ªè¿æ¥éƒ½æœ‰ä¸€ä¸ªä¸åŒçš„.HTML æ–‡ä»¶éœ€è¦åŠ è½½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">web-app&#x2F;</span><br><span class="line"> - index.html</span><br><span class="line"> - about.html</span><br><span class="line"> - faq.html</span><br><span class="line"> - careers.html</span><br></pre></td></tr></table></figure>

<p>æ¯ä¸ªé¡µé¢éƒ½è¦è®°è½½ä¸åŒçš„ HTML æ–‡ä»¶ã€‚</p>
<p>éšç€ JS æ¡†æ¶çš„å‡ºç°ï¼Œç½‘é¡µè¢«æµ‘æ²³æˆä¸ºä¸€ä¸ªå•ç‹¬çš„ js å¹¶ä¸€æ¬¡æ€§åŠ è½½å®Œæˆã€‚åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œæ—¶ï¼Œæµè§ˆå™¨ DOM ç”Ÿæˆæ‰€è¯·æ±‚çš„é¡µé¢ã€‚</p>
<p>åœ¨ React ä¸­ï¼Œå‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·çš„åº”ç”¨ç¨‹åºï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; (</span><br><span class="line">  &lt;Switch&gt;</span><br><span class="line">    &lt;Route path=<span class="string">"/about"</span> component=&#123;About&#125; /&gt;</span><br><span class="line">    &lt;Route path=<span class="string">"/faq"</span> component=&#123;FAQ&#125; /&gt;</span><br><span class="line">    &lt;Route path=<span class="string">"/careers"</span> component=&#123;Careers&#125; /&gt;</span><br><span class="line">  &lt;<span class="regexp">/Switch&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ about.js</span></span><br><span class="line"><span class="regexp">class About extends Component &#123;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return &lt;div&gt;About page&lt;/</span>div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// faq.js</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FAQ</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>FAQ page<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// careers.js</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Careers</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Careers page<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰“åŒ…æ—¶ï¼Œwebpack å°†æ‰€æœ‰çš„ js æ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ª<code>index.js</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">react-app&#x2F;</span><br><span class="line"> dist&#x2F;</span><br><span class="line">  - index.html</span><br><span class="line">  - index.js</span><br></pre></td></tr></table></figure>

<p>æ‰€æœ‰çš„æ–‡ä»¶åŒ…æ‹¬ index.js, about.js, faq.js, careers.js éƒ½æ†ç»‘åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚ç°åœ¨ï¼Œå½“æˆ‘ä»¬åŠ è½½ index.html æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šæ²¿ç€è´Ÿè½½å¾ˆé‡çš„ index.js è¢«åŠ è½½ã€‚ç°åœ¨ï¼Œè§£æ index.js å’Œæ¸²æŸ“ä¸­çš„æ‰€æœ‰ä»£ç æ‰€èŠ±è´¹çš„æ—¶é—´ â° å°†æ˜¯æ¼«é•¿çš„ç­‰å¾…ã€‚å¦‚æœæ¯ä¸ªæ–‡ä»¶æ‰§è¡Œæ‰€èŠ±è´¹çš„æ—¶é—´å¦‚ä¸‹ï¼š</p>
<ul>
<li>index.js 2ms</li>
<li>about.js 10ms</li>
<li>faq.js 5ms</li>
<li>careers.js 9ms</li>
</ul>
<p>æ‰“åŒ…å:</p>
<ul>
<li>index.js 26ms</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬ä¼šç­‰å¾…<code>26ms</code>!!ä½†æ˜¯å¦‚æœæˆ‘ä»¬å¯ä»¥å°† React ä¸­çš„æ–‡ä»¶åˆ†å¼€å¹¶æŒ‰éœ€åŠ è½½å®ƒä»¬ï¼Œæˆ‘ä»¬å°†åœ¨<code>2ms</code>å†…çœ‹åˆ°ç¨‹åºåŠ è½½å¹¶ç›¸åº”ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†åŒ…æ‹†åˆ†æˆå¤šä¸ªå°å—å¹¶åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ï¼Œè€Œéä¸€æ¬¡æ€§ä¸‹è½½æ•´ä¸ªä»£ç ã€‚</p>
<p>å·²ç»æœ‰å¾ˆå¤šæŠ€æœ¯ç”¨äºæ”¯æŒå°† React apps åšä»£ç æ‹†åˆ†äº†ã€‚æˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚ä¸­æœ‰æ›´å¤šçš„è®²è§£ã€‚</p>
<h1 id="â¬Dynamic-Import"><a href="#â¬Dynamic-Import" class="headerlink" title="â¬Dynamic Import"></a>â¬Dynamic Import</h1><p>ä¸ºäº†å°†æˆ‘ä»¬çš„ JS åº”ç”¨åšä»£ç åˆ†å‰²ï¼Œå°†å¼•å…¥ import()å‡½æ•°ï¼Œç›®å‰å®ƒä»æ˜¯ä¸€ä¸ªææ¡ˆï¼Œå°šæœªæˆä¸º JavaScript æ ‡å‡†çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>æ­¤åŠŸèƒ½å¯ä»¥å°†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ‹†åˆ†æˆä¸ºå—å¹¶æŒ‰éœ€åŠ è½½å®ƒä»¬ã€‚</p>
<p>The import()æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ã€‚å­—ç¬¦ä¸²æ˜¯å°†è¦åŠ è½½çš„ js æ–‡ä»¶çš„è·¯å¾„ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="string">"./js_file_to_load.js"</span>);</span><br></pre></td></tr></table></figure>

<p>å½“ webpack é‡åˆ°è¿™ç§æƒ…å†µæ—¶ï¼Œå®ƒå°±ä¼šå°†æ–‡ä»¶åˆ†åˆ«æ†ç»‘åœ¨ä¸åŒè·¯å¾„ä¸­ã€‚</p>
<h1 id="ğŸ’¤React-lazy"><a href="#ğŸ’¤React-lazy" class="headerlink" title="ğŸ’¤React.lazy()"></a>ğŸ’¤React.lazy()</h1><p>React.lazy æ˜¯ Reactv16.6 å‘å¸ƒæ—¶æ·»åŠ åˆ° React çš„æ–°ç‰¹æ€§ï¼Œå®ƒä¸ºæˆ‘ä»¬çš„ React ç»„ä»¶æä¾›äº†ä¸€ç§ç®€å•ç›´æ¥çš„æ–¹æ³•æ¥å®Œæˆå»¶è¿ŸåŠ è½½å’Œä»£ç åˆ†å‰²ã€‚</p>
<blockquote>
<p><em>React.lazy å‡½æ•°å…è®¸ä½ å°†åŠ¨æ€å¯¼å…¥çš„ç»„ä»¶æŒ‰å¸¸è§„å‘ˆç°ã€‚â€Šâ€”</em>â€Š<a href="http://reactjs.org/docs/code-splitting.html" target="_blank" rel="noopener"><em>React blog</em></a></p>
</blockquote>
<p>React.lazy å¯ä»¥è½»æ¾åˆ›å»ºå’Œæ¸²æŸ“ç»„ä»¶å¹¶åŠ¨æ€çš„å¯¼å…¥å®ƒä»¬ã€‚React.lazy å°†å‡½æ•°ä½œä¸ºå‚æ•°ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">React.lazy(<span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;);</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cb</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">React.lazy(cb);</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå›è°ƒå‡½æ•°å¿…é¡»ä½¿ç”¨åŠ¨æ€<code>import()</code>è¯­æ³•æ¥åŠ è½½ç»„ä»¶çš„æ–‡ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// MyComponent.js</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>MyComponent<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> MyComponent = React.lazy(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">import</span>(<span class="string">"./MyComponent.js"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AppComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;MyComponent /&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ or</span></span><br><span class="line"><span class="regexp">function cb() &#123;</span></span><br><span class="line"><span class="regexp">  return import("./</span>MyComponent.js<span class="string">");</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">const MyComponent = React.lazy(cb);</span></span><br><span class="line"><span class="string">function AppComponent() &#123;</span></span><br><span class="line"><span class="string">  return (</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">      &lt;MyComponent /&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  );</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p>React.lazy çš„å›è°ƒå‡½æ•°ä¼šé€šè¿‡<code>import()</code>çš„è°ƒç”¨è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚å¦‚æœæ¨¡å—åŠ è½½æˆåŠŸåˆ™ Promise å¯¹è±¡ resolveï¼Œå¦‚æœç”±äºç½‘ç»œæ•…éšœï¼Œè·¯å¾„è§£æé”™è¯¯ï¼Œæ‰¾ä¸åˆ°æ–‡ä»¶ç­‰åŸå› åŠ è½½æ¨¡å—æ—¶å‡ºé”™ï¼Œåˆ™ Promise å¯¹è±¡ rejectã€‚</p>
<p>å½“ webpack éå†æˆ‘ä»¬çš„ä»£ç è¿›è¡Œç¼–è¯‘æ‰“åŒ…çš„æ—¶å€™ï¼Œå®ƒä¼šåœ¨é‡åˆ°<code>React.lazy()</code>å’Œ<code>import()</code>æ—¶ï¼Œåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„æ†ç»‘åŒ…ã€‚æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°†å¦‚ä¸‹æ˜¾ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">react-app</span><br><span class="line"> dist&#x2F;</span><br><span class="line">  - index.html</span><br><span class="line">  - main.b1234.js (contains Appcomponent and bootstrap code)</span><br><span class="line">  - mycomponent.bc4567.js (contains MyComponent)</span><br><span class="line">&#x2F;** index.html **&#x2F;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;div id&#x3D;&quot;root&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;script src&#x3D;&quot;main.b1234.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåˆ†ä¸ºå¤šä¸ªæ†ç»‘åŒ…ã€‚å½“ AppComponent è¢«æ¸²æŸ“çš„æ—¶å€™ï¼Œmycomponent.bc4567.js æ–‡ä»¶å°†è¢«åŠ è½½å¹¶åœ¨ DOM ä¸Šçš„æ˜¾ç¤ºåŒ…å« MyComponentã€‚</p>
<blockquote>
<p>è¯‘è€…æ³¨ï¼šç›®å‰ React.lazy è¿˜ä¸æ”¯æŒæœåŠ¡ç«¯ä½¿ç”¨ï¼Œç›®å‰å®˜æ–¹æ¨èä½¿ç”¨<a href="https://github.com/smooth-code/loadable-components" target="_blank" rel="noopener">Loadable Components</a>ï¼Œå®ƒæœ‰å¾ˆæ£’çš„<a href="https://github.com/smooth-code/loadable-components/blob/master/packages/server/README.md" target="_blank" rel="noopener">æœåŠ¡ç«¯æ¸²æŸ“æŒ‡å—</a>ã€‚æˆ–è€…ä½ ä¹Ÿå¯ä»¥å°è¯•ä½¿ç”¨<a href="https://github.com/jamiebuilds/react-loadable" target="_blank" rel="noopener">react-loadable</a>ï¼Œè¿™æ˜¯ä¸€ä¸ªå°å‹åº“ï¼Œç”¨äºåŠ è½½å…·æœ‰åŠ¨æ€å¯¼å…¥ç»„ä»¶çš„é«˜é˜¶ç»„ä»¶ï¼Œä½¿ç”¨å®ƒä½ å¯ä»¥å®Œæˆé”™è¯¯è¶…æ—¶çŠ¶æ€é…ç½®ã€é¿å…åŠ è½½é—ªçƒã€åŠ è½½å¤šä¸ªèµ„æºã€é¢„åŠ è½½ã€æœåŠ¡ç«¯æ¸²æŸ“ç­‰åŠŸèƒ½ã€‚</p>
</blockquote>
<h1 id="ğŸš¦React-Suspense"><a href="#ğŸš¦React-Suspense" class="headerlink" title="ğŸš¦React Suspense"></a>ğŸš¦React Suspense</h1><p>ç°åœ¨ï¼Œå½“æ–‡ä»¶ mycomponent.bc4567.js è¢«åŠ è½½æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œä»åŠ è½½åˆ° MyComponent è¢«æ¸²æŸ“å¿…å®šä¼šæœ‰ä¸€ä¸ªæ—¶é—´å»¶è¿Ÿã€‚ç”¨æˆ·ä¼šçœ‹åˆ°ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>æ˜¾ç„¶ï¼Œä½ çš„åº”ç”¨ç¨‹åºä¼¼ä¹ä¼šå†»ç»“ä¸€æ®µæ—¶é—´ã€‚è¿™å°†æ˜¯ä¸ªç³Ÿç³•çš„ç”¨æˆ·ä½“éªŒã€‚æˆ‘ä»¬éœ€è¦è®©ç”¨æˆ·æŒ‡å¯¼æ­£åœ¨å‘ç”Ÿæˆ–åŠ è½½çš„äº‹æƒ…ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ·»åŠ äº†ä¸ React.lazy ç›¸å…³è”çš„æ–°ç‰¹æ€§ï¼Œä»–å°±æ˜¯<code>Suspense</code>ç»„ä»¶ã€‚</p>
<p>Suspense ç»„ä»¶ç”¨äºåŒ…è£…å»¶è¿Ÿç»„ä»¶ï¼Œä»¥åœ¨åŠ è½½æƒ°æ€§ç»„ä»¶æ—¶æ˜¾ç¤ºä¸€äº›å¤‡ç”¨ä¿¡æ¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Lazycomponent = React.lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">"./lazy.component.js"</span>));</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AppComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Suspense fallback=&#123;&lt;div&gt;loading ...&lt;<span class="regexp">/div&gt;&#125;&gt;</span></span><br><span class="line"><span class="regexp">        &lt;LazyComponent /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/Suspense&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­£åœ¨å»¶è¿ŸåŠ è½½çš„ç»„ä»¶å°†æ’å…¥åˆ° Suspense ç»„ä»¶çš„æ ‡è®°å†…ã€‚å‘ç”¨æˆ·å±•ç¤ºçš„å†…å®¹å‘Šè¯‰ä»–ä»¬æ­£åœ¨è¿›è¡Œçš„å†…å®¹æ”¾åœ¨ Suspense ç»„ä»¶æ ‡è®°çš„ fallback prop ä¸­ã€‚</p>
<p>ç»„ä»¶ä¹Ÿå¯ä»¥ç”¨äº fallback propï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LoadingIndicator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>loading ...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AppComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Suspense fallback=&#123;&lt;LoadingIndicator /&gt;&#125;&gt;</span><br><span class="line">        &lt;LazyComponent /&gt;</span><br><span class="line">      &lt;<span class="regexp">/Suspense&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å† Suspense æ ‡è®°ä¸­æ”¾ç½®å¤šä¸ªæƒ°æ€§ç»„ä»¶ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Lazycomponent1 = React.lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">"./lazy.component1.js"</span>));</span><br><span class="line"><span class="keyword">const</span> Lazycomponent2 = React.lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">"./lazy.component2.js"</span>));</span><br><span class="line"><span class="keyword">const</span> Lazycomponent3 = React.lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">"./lazy.component3.js"</span>));</span><br><span class="line"><span class="keyword">const</span> Lazycomponent4 = React.lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">"./lazy.component4.js"</span>));</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AppComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;Suspense fallback=&#123;&lt;div&gt;loading ...&lt;<span class="regexp">/div&gt;&#125;&gt;</span></span><br><span class="line"><span class="regexp">      &lt;LazyComponent1 /</span>&gt;</span><br><span class="line">      &lt;LazyComponent2 /&gt;</span><br><span class="line">      &lt;LazyComponent3 /&gt;</span><br><span class="line">      &lt;LazyComponent4 /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Suspense&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ğŸ‘®-æ•è·åŠ è½½é”™è¯¯"><a href="#ğŸ‘®-æ•è·åŠ è½½é”™è¯¯" class="headerlink" title="ğŸ‘® æ•è·åŠ è½½é”™è¯¯"></a>ğŸ‘® æ•è·åŠ è½½é”™è¯¯</h1><p>åœ¨æˆ‘ä»¬ä½¿ç”¨ React.lazy æ—¶ï¼Œæˆ‘ä»¬æåˆ° import()å‡½æ•°ä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¯èƒ½ä¼šç”±äºæŸäº›åŸå› åœ¨ reject ä¸­è¿”å›åŠ è½½é”™è¯¯ï¼š</p>
<ul>
<li>ç½‘ç»œæ•…éšœ</li>
<li>æ–‡ä»¶æœªæ‰¾åˆ°</li>
<li>æ–‡ä»¶è·¯å¾„é”™è¯¯</li>
</ul>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå› ä¸ºè¿™äº›æ‚²æƒ¨åœ°å‘ç”Ÿé”™è¯¯ã€‚æˆ‘ä»¬å¸Œæœ›è£è€€çš„æœ‰å°Šä¸¥åœ°é”™è¯¯ã€‚ä¸ºäº†åœ¨å¤±è´¥æ—¶å±•ç°å‡ºè‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œæˆ‘ä»¬å°†åœ¨æƒ°æ€§ç»„ä»¶ä¸Šæ”¾ç½®ä¸€ä¸ªé”™è¯¯è¾¹ç•Œã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Lazycomponent1 = React.lazy(<span class="function"><span class="params">()</span>=&gt;</span><span class="keyword">import</span>(<span class="string">'./lazy.component1.js'</span>))</span><br><span class="line"><span class="keyword">const</span> Lazycomponent2 = React.lazy(<span class="function"><span class="params">()</span>=&gt;</span><span class="keyword">import</span>(<span class="string">'./lazy.component2.js'</span>))</span><br><span class="line"><span class="keyword">const</span> Lazycomponent3 = React.lazy(<span class="function"><span class="params">()</span>=&gt;</span><span class="keyword">import</span>(<span class="string">'./lazy.component3.js'</span>))</span><br><span class="line"><span class="keyword">const</span> Lazycomponent4 = React.lazy(<span class="function"><span class="params">()</span>=&gt;</span><span class="keyword">import</span>(<span class="string">'./lazy.component4.js'</span>))</span><br><span class="line"><span class="keyword">import</span> ErrorBoundary <span class="keyword">from</span> <span class="string">'./error.boundary.js'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AppComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;ErrorBoundary&gt;</span><br><span class="line">            &lt;Suspense fallback=&#123;&lt;div&gt;loading ...&lt;<span class="regexp">/div&gt;&#125;&gt;</span></span><br><span class="line"><span class="regexp">                &lt;LazyComponent1 /</span>&gt;</span><br><span class="line">                &lt;LazyComponent2 /&gt;</span><br><span class="line">                &lt;LazyComponent3 /&gt;</span><br><span class="line">                &lt;LazyComponent4 /&gt;</span><br><span class="line">            &lt;<span class="regexp">/Suspense&gt;</span></span><br><span class="line"><span class="regexp">        &lt;ErrorBoundary/</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="âœ‚-åŸºäºè·¯ç”±ï¼ˆroute-basedï¼‰çš„ä»£ç æ‹†åˆ†"><a href="#âœ‚-åŸºäºè·¯ç”±ï¼ˆroute-basedï¼‰çš„ä»£ç æ‹†åˆ†" class="headerlink" title="âœ‚ åŸºäºè·¯ç”±ï¼ˆroute-basedï¼‰çš„ä»£ç æ‹†åˆ†"></a>âœ‚ åŸºäºè·¯ç”±ï¼ˆroute-basedï¼‰çš„ä»£ç æ‹†åˆ†</h1><p>å¦‚ä½•æ‹†åˆ†ä»£ç æ˜¯ä¸ªæ£˜æ‰‹çš„é—®é¢˜ã€‚æœ‰ä¸¤ç§æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯åŸºäºè·¯ç”±ï¼ˆ<code>route-based</code>ï¼‰æ‹†åˆ†å’ŒåŸºäºç»„ä»¶ï¼ˆ<code>component-based</code>ï¼‰æ‹†åˆ†ã€‚</p>
<blockquote>
<p><em>åŸºäºè·¯ç”±çš„ä»£ç æ‹†åˆ†å°†åº”ç”¨ç¨‹åºåˆ†è§£ä¸ºæ¯ä¸ªè·¯ç”±å¯¹åº”çš„å—ã€‚</em></p>
</blockquote>
<p>åŸºäºè·¯ç”±çš„ä»£ç æ‹†åˆ†æ˜¯å°†ä»£ç æ‹†åˆ†ä¸ºä¸åº”ç”¨ç¨‹åºè·¯ç”±ç›¸å…³çš„åŒ…ã€‚åœ¨ SPAï¼ˆsingle page web applicationï¼Œå•é¡µé¢åº”ç”¨ï¼‰ä¸­ï¼Œæ‰€æœ‰çš„ route æˆ– path éƒ½æ˜¯åœ¨ DOM ä¸Šå®Œæˆçš„ã€‚å½“ä½ ç‚¹å‡»è¶…é“¾æ¥æ—¶ï¼ŒDOM æ•è·äº‹ä»¶å¹¶é€šè¿‡ SPA æ¡†æ¶è¿è¡Œå®ƒï¼Œåœ¨ DOM ä¸­å°†é”€æ¯å½“å‰è§†å›¾å½“ç»„ä»¶é™„åŠ è¯·æ±‚è·¯å¾„åˆ›å»ºå¹¶å‘ˆç°çš„æ—¶å€™ã€‚</p>
<p>æ‰€æœ‰çš„è¿™äº›ç»„ä»¶éƒ½æ†ç»‘åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­è¢«ä¼ é€’ã€‚ç°åœ¨ï¼Œé€šè¿‡åŸºäºè·¯ç”±çš„åˆ†å—ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»£ç åˆ†æˆå—ã€‚æ¯ä¸ªå—åªä¸ç‰¹å®šè·¯ç”±æœ‰å…³ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index,js</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">const</span> App = <span class="function"><span class="params">()</span> =&gt;</span> (</span><br><span class="line">  &lt;Switch&gt;</span><br><span class="line">    &lt;Route path=<span class="string">"/about"</span> component=&#123;About&#125; /&gt;</span><br><span class="line">    &lt;Route path=<span class="string">"/faq"</span> component=&#123;FAQ&#125; /&gt;</span><br><span class="line">    &lt;Route path=<span class="string">"/careers"</span> component=&#123;Careers&#125; /&gt;</span><br><span class="line">  &lt;<span class="regexp">/Switch&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬ä½¿ç”¨åŸºäºè·¯ç”±çš„æ–¹æ³•æ‹†åˆ†æ¬¡åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">react-app&#x2F;</span><br><span class="line"> - index.html</span><br><span class="line"> - index.bacd0123.js (contains App)</span><br><span class="line"> - about.1234.js (contains About component)</span><br><span class="line"> - faq.5678.js (contains FAQ component)</span><br><span class="line"> - careers.9012.js (contains Careers component)</span><br><span class="line">&#x2F;** index.html **&#x2F;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;div id&#x3D;&quot;root&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;script src&#x3D;&quot;index.bacd0123.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬åŠ è½½æˆ‘ä»¬çš„ app è·¯å¾„<code>/</code>æ—¶ï¼Œåº”ç”¨ä»…å‘ˆç°è¯¥é¡µé¢ã€‚ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬å¯¼èˆªåˆ°<code>/faq</code>ï¼Œé‚£ä¹ˆ faq.5678.js æ–‡ä»¶å°†é€šè¿‡ç½‘ç»œè·å–å¹¶åŠ è½½ï¼ŒåŒ…æ‹¬ç»„ä»¶ FAQ å°†è¢«æ¸²æŸ“ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°çš„ä»£ç æ˜¯æ ¹æ®æˆ‘ä»¬å®šä¹‰çš„è·¯ç”±è¿›è¡Œæ‹†åˆ†çš„ã€‚è¿™å¹¶æ²¡æœ‰ 100%ä¼˜åŒ–æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œä½†è‡³å°‘æˆ‘ä»¬ä»æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­å‡å°‘äº†ç›¸å½“å¤§çš„å»¶è¿Ÿæ—¶é—´ã€‚è¿™ä¸ªä¸ä»£ç åˆ†å‰²ç›¸å…³çš„å¦ä¸€ç§ä¼˜åŒ–æŠ€æœ¯è¢«ç§°ä¸º prefetchingï¼Œä½†è¿™å°†åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ã€‚</p>
<h1 id="ğŸ”ª-åŸºäºç»„ä»¶ï¼ˆComponent-basedï¼‰çš„ä»£ç æ‹†åˆ†"><a href="#ğŸ”ª-åŸºäºç»„ä»¶ï¼ˆComponent-basedï¼‰çš„ä»£ç æ‹†åˆ†" class="headerlink" title="ğŸ”ª åŸºäºç»„ä»¶ï¼ˆComponent-basedï¼‰çš„ä»£ç æ‹†åˆ†"></a>ğŸ”ª åŸºäºç»„ä»¶ï¼ˆComponent-basedï¼‰çš„ä»£ç æ‹†åˆ†</h1><p>åœ¨ Web åº”ç”¨ç¨‹åºä¸­ï¼Œæœ‰å¦‚ä¸‹è®¸å¤šå°éƒ¨ä»¶ï¼š</p>
<ul>
<li>æ¨¡å‹ï¼ˆmodalsï¼‰</li>
<li>tabs</li>
<li>æŠ˜å é¢æ¿ï¼ˆaccordionï¼‰</li>
<li>è¿›åº¦æ¡ï¼ˆprogressbarsï¼‰</li>
<li>ä¾§è¾¹èœå•ï¼ˆsidenavï¼‰</li>
<li>footer</li>
<li>header</li>
<li>é¢æ¿ï¼ˆpanelï¼‰</li>
<li>ç­‰ç­‰</li>
</ul>
<p>è¿™äº›å°éƒ¨ä»¶æˆ–ç»„ä»¶ä¸ºæˆ‘ä»¬çš„ç”¨æˆ·æä¾›äº†ä¸°å¯Œçš„ä½“éªŒã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ModalComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">modal</span>&gt;</span>Modal shows!!!<span class="tag">&lt;/<span class="name">modal</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Mycomponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.display = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;ModalComponent display=&#123;<span class="keyword">this</span>.dispaly&#125; /&gt;</span><br><span class="line">    &lt;button onclick=&#123;(<span class="keyword">this</span>.display = <span class="literal">true</span>)&#125;&gt;Open Modal&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;button onclick=&#123;(this.display = false)&#125;&gt;Close Modal&lt;/</span>button&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">react - app /</span> dist / -index.html - index.js;</span><br></pre></td></tr></table></figure>

<p>å°½ç®¡ä»–ä»¬æä¾›äº†å¾ˆå¤šå¥½ä¸œè¥¿ï¼Œä½†ä»–ä»¬ä¹Ÿä¼šå¯¼è‡´æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ€§èƒ½ä¸ä½³ã€‚å¤§å¤šæ•°ç»„ä»¶éšè—ï¼ŒæŒ‡å¯¼ç”¨æˆ·å®Œæˆç›¸å…³æ“ä½œæ—¶æ‰ä¼šæ˜¾ç°ã€‚åœ¨ç”¨æˆ·æ»šåŠ¨åˆ°åº•éƒ¨æˆ–æŒ‰ä¾§è¾¹æŒ‰é’®ä¹‹å‰ï¼Œä½ ä¸ä¼šçœ‹åˆ° footer å’Œ sidenevã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç”¨æˆ·ç”šè‡³å¯èƒ½ä¸ä¼šä¸å…¶ä¸­ä»»æ„ä¸€ä¸ªè¿›è¡Œäº¤äº’ã€‚</p>
<p>æ‰€æœ‰è¿™äº›éƒ½åŠ è½½åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå¹¶åœ¨åŠ è½½æ—¶æ„æˆæ—¶é—´å»¶è¿Ÿã€‚å½“ç”¨æˆ·è¯•å›¾ä¸ä»–ä»¬äº¤äº’æ—¶ï¼ŒåŠ è½½å¹¶å±•ç°ä»–ä»¬ä¸ä¼šæ›´å¥½ä¹ˆï¼Ÿ</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸºäºç»„ä»¶çš„æ‹†åˆ†æœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚æ‰€æœ‰çš„å°éƒ¨ä»¶æˆ–ç»„ä»¶éƒ½å°†å•ç‹¬æ‰“åŒ…ã€‚æ¯ä¸ªæ†ç»‘åŒ…ä¸Šä¸€ä¸ªå°éƒ¨ä»¶ï¼ŒWeb å¼€å‘äººå‘˜éœ€è¦é‡‡ç”¨æ†ç»‘æŠ€æœ¯ï¼Œä½†æ›´é‡è¦çš„æ˜¯æŒ‰éœ€åŠ è½½è¿™äº›éƒ¨ä»¶ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// modalcomponent.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ModalComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">modal</span>&gt;</span>Modal shows!!!<span class="tag">&lt;/<span class="name">modal</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// mycomponent.js</span></span><br><span class="line"><span class="keyword">const</span> ModalComponent = React.lazy(<span class="keyword">import</span>(<span class="string">'./modalcomponent.js'</span>))</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.display = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;Suspense fallback=&#123;&lt;div&gt;loading ...&lt;<span class="regexp">/div&gt;&#125;&gt;</span></span><br><span class="line"><span class="regexp">            &lt;ModalComponent display=&#123;this.display&#125; /</span>&gt;</span><br><span class="line">        &lt;<span class="regexp">/Suspense&gt;</span></span><br><span class="line"><span class="regexp">        &lt;button onclick=&#123;this.display = true&#125;&gt;Open Modal&lt;/</span>button&gt;</span><br><span class="line">        &lt;button onclick=&#123;<span class="keyword">this</span>.display = <span class="literal">false</span>&#125;&gt;Close Modal&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">const</span> MyComponent = React.lazy(<span class="function"><span class="params">()</span>=&gt;</span><span class="keyword">import</span>(<span class="string">'./mycomponent.js'</span>))</span><br><span class="line"><span class="keyword">import</span> ErrorBoundary <span class="keyword">from</span> <span class="string">'./error.boundary.js'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AppComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;ErrorBoundary&gt;</span><br><span class="line">            &lt;Suspense fallback=&#123;&lt;div&gt;loading ...&lt;<span class="regexp">/div&gt;&#125;&gt;</span></span><br><span class="line"><span class="regexp">                &lt;MyComponent /</span>&gt;</span><br><span class="line">            &lt;<span class="regexp">/Suspense&gt;</span></span><br><span class="line"><span class="regexp">        &lt;ErrorBoundary/</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">react-app/</span></span><br><span class="line"> dist/</span><br><span class="line">  - index.html</span><br><span class="line">  - index.js</span><br><span class="line">  - mycomponent.js</span><br><span class="line">  - modalcomponent.js (contains the ModalComponent)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹åˆ°æœ€åˆæ²¡æœ‰åŠ è½½ ModalComponentï¼Œä»–åœ¨ç”¨æˆ·å•å‡»<code>Open Modal</code>æŒ‰é’®æ—¶ï¼Œæ‰ä¼šè§¦å‘åŠ è½½ã€‚</p>
<h1 id="ğŸ”š-ç»“è®º"><a href="#ğŸ”š-ç»“è®º" class="headerlink" title="ğŸ”š ç»“è®º"></a>ğŸ”š ç»“è®º</h1><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•é€šè¿‡ä»£ç åˆ†å‰²å’Œå»¶è¿ŸåŠ è½½æ¥æ”¹è¿› ğŸš€React åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚é¦–å…ˆæˆ‘ä»¬ä»‹ç»äº†åŠ¨æ€ import()å‡½æ•°ï¼›ç„¶åï¼Œæˆ‘ä»¬çœ‹åˆ°äº†è¿˜å¯ä»¥ä½¿ç”¨ä¸åŒçš„æŠ€æœ¯æ–¹æ¡ˆï¼Œå¦‚ React çš„æ–°ç‰¹æ€§ ğŸ’¤<code>React.lazy()</code>å’Œ ğŸš¦<code>Suspense</code>ã€‚</p>
<p>é€šè¿‡æˆ‘ä»¬åœ¨è¿™ç¯‡æ–‡ç« ä¸­å­¦åˆ°çš„è¿™äº›ä¸åŒçš„ä¼˜åŒ–æŠ€å·§ï¼Œæˆ‘ä»¬å¯ä»¥ç”Ÿæˆé«˜æ€§èƒ½é«˜è´¨é‡çš„ React åº”ç”¨ã€‚</p>
<p>å¦‚æœä½ å¯¹æ­¤æœ‰ä»»ä½•é—®é¢˜ï¼Œæˆ–è€…æˆ‘æœ‰ä»»ä½•é—æ¼ï¼Œè¯·éšæ—¶åœ¨ä¸‹é¢å‘è¡¨è¯„è®ºæˆ–å‘æˆ‘è¯¢é—®ä»»ä½•é—®é¢˜ï¼ğŸ‘ ä½ ä¹Ÿå¯ä»¥åœ¨<a href="https://twitter.con/@ngarchangel" target="_blank" rel="noopener">Twitter</a>, <a href="https://facebook.com/philip.david.5011" target="_blank" rel="noopener">Facebook</a>å’Œè¿™é‡Œæ‰¾åˆ°æˆ‘ã€‚</p>
<p>èŸ¹èŸ¹ !!!ğŸ’¯</p>
<h1 id="ğŸ’Credits"><a href="#ğŸ’Credits" class="headerlink" title="ğŸ’Credits"></a>ğŸ’Credits</h1><ul>
<li><a href="https://gist.github.com/philipszdavido/reactjs.org/docs/code-splitting.html" target="_blank" rel="noopener">âœ…Reactjs Blog</a></li>
</ul>
<p>åŸæ–‡é“¾æ¥ï¼š <a href="https://blog.bitsrc.io/improve-react-performance-using-lazy-loading-and-suspense-933903171954" target="_blank" rel="noopener">Improve React Performance using Lazy LoadingğŸ’¤ and Suspense</a></p>
<p><a href="https://zakarycode.github.io/archives/front-end/frame/React/1546835543.html" target="_blank" rel="noopener">è½¬è½½é“¾æ¥</a></p>

      </div>
      <div class="post-copyright">
    <p class="copyright-item">
      <span>åŸæ–‡ä½œè€…: </span>
      <a href="https://xinpuchen.github.io">æ˜•æµ¦</a>
    </p>
    <p class="copyright-item">
      <span>åŸæ–‡é“¾æ¥: </span>
      <a href="https://xinpuchen.github.io/improve-react-performance-using-lazy-loading-and-suspense/">https://xinpuchen.github.io/improve-react-performance-using-lazy-loading-and-suspense/</a>
    </p>
    <p class="copyright-item">
      <span>è®¸å¯åè®®: </span><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…è®¸å¯åè®®</a>
    </p>
  </div>
      <footer class="post-footer">
        <div class="post-tags">
            <a href="/tags/JavaScript/">JavaScript</a>
            <a href="/tags/React/">React</a>
            <a href="/tags/Performance/">Performance</a>
            <a href="/tags/Web-Development/">Web Development</a>
            <a href="/tags/Programming/">Programming</a>
            </div>
        
        <nav class="post-nav"><a class="prev" href="/Why-Isn%E2%80%99t-X-a-Hook/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">ä¸ºä»€ä¹ˆé€‰æ‹©Hookè€Œéâ€¦â€¦?</span>
        <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
      </a>
    <a class="next" href="/React-16.6.*/">
        <span class="next-text nav-default">React 16.6 å‘å¸ƒï¼Œä¸€å¤§æ³¢æ–°åŠŸå¸¦ä½ çœ‹æœªæ¥çš„ React å¼€å‘æ–¹å¼</span>
        <span class="prev-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"><div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:xinpuchen@foxmail.com" class="iconfont icon-email" title="email"></a>
        <a href="https://www.linkedin.com/in/xinpuchen" target="_blank" rel="noopener" class="iconfont icon-linkedin" title="linkedin"></a>
        <a href="https://github.com/xinpuchen" target="_blank" rel="noopener" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even" target="_blank" rel="noopener">Even</a>
  </span>

  <span class="copyright-year">&copy;2018 - 2020<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">æ˜•æµ¦</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'https://xinpuchen.github.io/improve-react-performance-using-lazy-loading-and-suspense/';
        this.page.identifier = 'improve-react-performance-using-lazy-loading-and-suspense/';
        this.page.title = 'ä½¿ç”¨æ‡’åŠ è½½å’ŒSuspenseæé«˜Reactæ€§èƒ½';
    };
    (function() {
    var d = document, s = d.createElement('script');

    s.src = '//xinpuchen.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();  
  </script>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"/>


<script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script>

<script>
  var gitalk = new Gitalk({
    clientID: 'GitHub Application Client ID',
    clientSecret: 'GitHub Application Client Secret',
    repo: 'GitHub repo',
    owner: 'GitHub repo owner',
    admin: ['GitHub repo owner and collaborators, only these guys can initialize github issues'],
    id: md5(location.pathname),
    
      language: 'zh-CN',
    
    distractionFreeMode: 'true'
  });
  gitalk.render('gitalk-container');
</script><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
